---
title: YOLO_11_based_video_mosaic_processing_and_capture_function_Integrated_full_function
emoji: ğŸŒ–
colorFrom: yellow
colorTo: pink
sdk: gradio
sdk_version: 5.29.0
app_file: app.py
pinned: false
license: mit
short_description: YOLO 11 ëª¨ë¸ ê¸°ë°˜ ë™ì˜ìƒ ë‚´ ì‚¬ëŒ í˜•ìƒ ëª¨ìì´í¬ ë° í”„ë ˆì„ ë‹¨ìœ„ ì´ë¯¸ì§€ ìº¡ì³ ê¸°ëŠ¥ êµ¬í˜„
---
# YOLO_11_based_video_mosaic_processing_and_capture_function_Integrated_full_function
## shin0624 ë‚´ Space ê¸°ëŠ¥ ëª¨ë‘ í†µí•©
**YOLO 11** ëª¨ë¸ ê¸°ë°˜ ë™ì˜ìƒ ë‚´ ì‚¬ëŒ í˜•ìƒ ëª¨ìì´í¬ ë° í”„ë ˆì„ ë‹¨ìœ„ ì´ë¯¸ì§€ ìº¡ì³ ê¸°ëŠ¥ êµ¬í˜„
**HuggingPace Spaces**ë¥¼ í†µí•´ Gradio ê¸°ë°˜ í˜¸ìŠ¤íŒ…
**https://huggingface.co/spaces/shin0624/YOLO_11_based_video_mosaic_processing_and_capture_function_Integrated_full_function**

![Image](https://github.com/user-attachments/assets/e8c2669d-9698-4d26-8c5f-8fd9e72cc765)

## Licenses
- ë³¸ í”„ë¡œì íŠ¸ ì½”ë“œ: **MIT License**
- YOLOv11 ëª¨ë¸: **AGPL-3.0** ([Ultralytics ê³µì‹ ë¬¸ì„œ](https://ultralytics.com/license))
- Gradio: **Apache-2.0**

# ê¸°ìˆ  ìŠ¤íƒ
![License](https://img.shields.io/badge/License-MIT%2FAGPL--3.0-blue)
<img src="https://img.shields.io/badge/huggingface-FFD21E?style=for-the-badge&logo=huggingface&logoColor=white">
<img src="https://img.shields.io/badge/yolo11-111F68?style=for-the-badge&logo=yolo&logoColor=white">
<img src="https://img.shields.io/badge/Gradio-F97316?style=for-the-badge&logo=Gradio&logoColor=white">
![Python](https://img.shields.io/badge/python-3670A0?style=for-the-badge&logo=python&logoColor=ffdd54)
![GitHub](https://img.shields.io/badge/github-%23121011.svg?style=for-the-badge&logo=github&logoColor=white)
![Google Colab](https://img.shields.io/badge/Google%20Colab-%23F9A825.svg?style=for-the-badge&logo=googlecolab&logoColor=white)

# êµ¬í˜„ëœ ê¸°ëŠ¥ ì„¤ëª…

## ì…ë ¥ ë°©ì‹

- ë¡œì»¬ íŒŒì¼ ì—…ë¡œë“œ ë˜ëŠ” Google Drive ë§í¬ ì…ë ¥ ê°€ëŠ¥

- ë™ì˜ìƒ í˜•ì‹: mp4, mov ë“± OpenCVê°€ ì§€ì›í•˜ëŠ” í˜•ì‹

## í•µì‹¬ ì²˜ë¦¬ ê¸°ëŠ¥

- YOLOv11ì„ ì´ìš©í•œ ì‹¤ì‹œê°„ ì‚¬ëŒ ê²€ì¶œ

- ê²€ì¶œëœ ì˜ì—­ì— ëª¨ìì´í¬ ì²˜ë¦¬ ì ìš©

- ì‚¬ìš©ì ì •ì˜ ê°€ëŠ¥í•œ í”„ë ˆì„ ìº¡ì³ ê°„ê²©

- í•´ìƒë„ ì¡°ì • ê¸°ëŠ¥ (50%~100%)

- ìš©ëŸ‰ ì œí•œ ë° ìµœëŒ€ ì´ë¯¸ì§€ ìˆ˜ ì œì–´

## ì§„í–‰ ìƒíƒœ í‘œì‹œ

- ì‹¤ì‹œê°„ ì²˜ë¦¬ ì§„í–‰ë¥  ìŠ¬ë¼ì´ë”

- í˜„ì¬ ì‚¬ìš© ìš©ëŸ‰ ë° ìµœëŒ€ ìš©ëŸ‰ í‘œì‹œ

- ë¹„ë™ê¸° ì²˜ë¦¬ë¡œ ì§„í–‰ ìƒíƒœ ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸

## ì¶œë ¥

- ì²˜ë¦¬ëœ í”„ë ˆì„ë“¤ì„ ZIP íŒŒì¼ë¡œ íŒ¨í‚¤ì§•

- ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•œ íŒŒì¼ ì¶œë ¥

## ëŒ€ìš©ëŸ‰ ì²˜ë¦¬

- Google Drive ë§í¬ë¥¼ í†µí•œ ëŒ€ìš©ëŸ‰ íŒŒì¼ ì§ì ‘ ì²˜ë¦¬

- ë©”ëª¨ë¦¬ ê´€ë¦¬ë¥¼ ìœ„í•œ ì ì§„ì  ì²˜ë¦¬ ë°©ì‹

- ì•ˆì „í•œ ì„ì‹œ íŒŒì¼ ì²˜ë¦¬

# 250511 ê°œì„  ì‚¬í•­
**1. ì‘ì—… ì‹œê°„ ê°œì„ **
- í˜„ì¬ cv.VideoCaptureë¡œ í”„ë ˆì„ë§ˆë‹¤ .set() -> .read()í•˜ëŠ”ë°, ì´ëŠ” ë§¤ìš° ëŠë¦¼.
- GPU ë°°ì¹˜ ì²˜ë¦¬ ì‚¬ìš©
```
a. BATCH_SIZE ì„¤ì •ì„ í†µí•´ í•œ ë²ˆì— ì—¬ëŸ¬ í”„ë ˆì„ ì²˜ë¦¬
b. amp.autocast()ë¡œ í˜¼í•© ì •ë°€ë„ ì—°ì‚° í™œì„±í™”
c. torch.backends.cudnn.benchmarkë¡œ ì»¨ë³¼ë£¨ì…˜ ìµœì í™”
```
  
- íŒŒì´í”„ë¼ì¸ ë³‘ë ¬í™”
```
a. í”„ë ˆì„ ìˆ˜ì§‘ -> ë°°ì¹˜ ì¶”ë¡  -> í›„ì²˜ë¦¬ë¥¼ ë³„ë„ ìŠ¤ë ˆë“œì—ì„œ ì²˜ë¦¬
b. ThreadPoolExecutorë¡œ CPU ì§‘ì•½ ì‘ì—… ë³‘ë ¬í™”
```
  
- ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ ëª¨ë“œ
```
a. model.predict(stream=True)ë¡œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”
b. ì—°ì†ëœ í”„ë ˆì„ ì²˜ë¦¬ ì‹œ ë‚´ë¶€ ë²„í¼ ì¬ì‚¬ìš©
```

- ë¹„ë™ê¸° I/Oì‘ì—…
```
  ì˜ìƒ ì½ê¸° <-> ëª¨ë¸ ì¶”ë¡  <-> íŒŒì¼ ì €ì¥ ë‹¨ê³„ ì˜¤ë²„ë˜í•‘
  CUDA ìŠ¤íŠ¸ë¦¼ê³¼ íŒŒì´ì¬ ìŠ¤ë ˆë“œ ì¡°í•©ì„ ì‚¬ìš©
```

**2. ì£¼ìš” ìµœì í™” í¬ì¸íŠ¸**
- íŒŒì´í”„ë¼ì¸ ë³‘ë ¬í™” ì•„í‚¤í…ì²˜
```
a. í”„ë ˆì„ ìˆ˜ì§‘ â†’ ì „ì²˜ë¦¬ â†’ GPU ë°°ì¹˜ ì¶”ë¡  â†’ í›„ì²˜ë¦¬ â†’ ì••ì¶• ë‹¨ê³„ë¥¼ ì˜¤ë²„ë© ì²˜ë¦¬
b. CPU/GPU ì‘ì—… ë¶„ë¦¬ë¡œ ë¦¬ì†ŒìŠ¤ í™œìš© ê·¹ëŒ€í™”
```

- í˜¼í•© ì •ë°€ë„ ì—°ì‚°(Mixed Precision)
```
a. autocast() ì»¨í…ìŠ¤íŠ¸ ë§¤ë‹ˆì €ë¡œ FP16 ì—°ì‚° í™œì„±í™”
b. ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 40% ê°ì†Œ, ì²˜ë¦¬ ì†ë„ 2ë°° í–¥ìƒ ê¸°ëŒ€
```

- ìŠ¤ë§ˆíŠ¸ ë°°ì¹˜ ì²˜ë¦¬
```
a. ë™ì  ë°°ì¹˜ í¬ê¸° ì¡°ì •
b. í•œ ë²ˆì˜ ëª¨ë¸ í˜¸ì¶œë¡œ ë‹¤ì¤‘ í”„ë ˆì„ ì²˜ë¦¬
```

- ë¹„ë™ê¸° I/O ê´€ë¦¬
```
a. ì˜ìƒ ì½ê¸°ì™€ ZIP ì••ì¶• ì“°ê¸°ë¥¼ ë³„ë„ ìŠ¤ë ˆë“œì—ì„œ ì²˜ë¦¬
b. CUDA ìŠ¤íŠ¸ë¦¼ê³¼ Python ìŠ¤ë ˆë“œ í’€ ì—°ë™
```

- ë©”ëª¨ë¦¬ ìµœì í™”
```
a. í”„ë ˆì„ ë°ì´í„°ì˜ BGR/RGB ë³€í™˜ ìµœì†Œí™”
b. ê²°ê³¼ ë²„í¼ ì¦‰ì‹œ ë°©ì¶œ(streaming) ë°©ì‹ ì±„íƒ
```

**3. ì‘ì—… ê²°ê³¼ ê²€ì¦**
- 84.5MB í¬ê¸°ì˜ 1ë¶„ 37ì´ˆ ì˜ìƒ ì‘ì—… ì‹œ ê¸°ì¡´ ì½”ë“œì™€ ê°œì„ ëœ ì½”ë“œì˜ íš¨ìœ¨ì„ ê²€ì¦
- ë””ë°”ì´ìŠ¤ í™˜ê²½ : Nvidia T4 small (4vCPU, 15GB RAM, 16GB VRAM) (Huggingface Pro ìš”ê¸ˆì œ êµ¬ë…)
- ê²°ê³¼ ë„ì¶œ ì¡°ê±´ : í”„ë ˆì„ ê°„ê²© 5, í•´ìƒë„ 100%, ë™ì˜ìƒì„ ë¡œì»¬ì—ì„œ ì§ì ‘ ì—…ë¡œë“œ
  
**- ì‘ì—… ê²°ê³¼**
  ```
- í”„ë ˆì„ ìˆ˜ì§‘ ë° ì „ì²˜ë¦¬ : 03ë¶„36ì´ˆ
- í›„ì²˜ë¦¬ ë° ì••ì¶• : 03ë¶„ 23ì´ˆ
- ì´ ì‘ì—… ì†Œìš” ì‹œê°„ : 06ë¶„ 59ì´ˆ
- ê²°ê³¼ë¬¼ ìš©ëŸ‰ : 120.4MB
  ```
### ì „ì²˜ë¦¬ ê²°ê³¼
![Image](https://github.com/user-attachments/assets/0f747455-6cd3-4b53-bbc2-04aca87195c3)

### í›„ì²˜ë¦¬ ê²°ê³¼
![Image](https://github.com/user-attachments/assets/28ea7d9c-b482-499b-a6d3-c2c778777e34)

**4. Gradio ì¸í„°í˜ì´ìŠ¤ë¥¼ ìˆ˜ì •í•˜ì—¬, ìƒë‹¨ì— gr.Textboxë¥¼ ë°°ì¹˜.**
- html blockì„ ì‚¬ìš©í•˜ì—¬ gpuëŠ” ì´ˆë¡ìƒ‰, cpuëŠ” ë¹¨ê°„ìƒ‰ìœ¼ë¡œ í‘œì‹œí•˜ê³ , ì•„ì´ì½˜ ì¶”ê°€, ìˆ˜ë™ ìƒˆë¡œê³ ì¹¨ë„ ê°€ëŠ¥í•˜ë„ë¡ êµ¬ì„±.
- update()ì™€ live=True ì†ì„±ì„ í™œìš©í•˜ì—¬ ì•± ì‹¤í–‰ ì¤‘ì—ë„ ìì› ì‚¬ìš© ìƒíƒœë¥¼ ê°ì§€í•˜ì—¬ ì¸í„°í˜ì´ìŠ¤ì— ì‹¤ì‹œê°„ ë°˜ì˜.

**5. ThreadPoolExecutorë¥¼ ì´ìš©í•œ ì§ì ‘ ë³‘ë ¬í™” êµ¬í˜„ í…ŒìŠ¤íŠ¸**

	1. 2ë‹¨ê³„ ë³‘ë ¬í™” ì•„í‚¤í…ì²˜ êµ¬ì„±
		- ìƒìœ„ë ˆë²¨ : ë°°ì¹˜ë‹¨ìœ„ ë³‘ë ¬ì²˜ë¦¬(ThreadPoolExecutor)
		- í•˜ìœ„ë ˆë²¨ : GPU ë°°ì¹˜ì¶”ë¡  + OpenCV ë²¡í„°í™” ì—°ì‚°

	2. ë©”ëª¨ë¦¬ íš¨ìœ¨í™” ê¸°ë²•
		- í”„ë ˆì„ ë°ì´í„°ì˜ rgh/bgr ë³€í™˜ ìµœì†Œí™”
		- ë°°ì¹˜ ì²˜ë¦¬ ê°„ PGU ìºì‹œ ìë™ ê´€ë¦¬
		- ê²°ê³¼ ë²„í¼ ì¦‰ì‹œ ë””ìŠ¤í¬ì— ê¸°ë¡

	3. Huggingface ì œí•œ ì‚¬í•­ ëŒ€ì‘
		- MAX_WORKERS = 4ë¡œ ì•ˆì •ì„± ë³´ì¥
		- BATCH_SIZE = 8ë¡œ VRAM íš¨ìœ¨ ê´€ë¦¬
		- í ì‹œìŠ¤í…œ ê°„ì†Œí™”

	4. ì—ëŸ¬ ë°©ì§€
		- êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë§í¬ íŒŒì‹± ì˜¤ë¥˜ ì²˜ë¦¬
		- ë¹„ë””ì˜¤ íŒŒì¼ ì—´ê¸° ì‹¤íŒ¨ ì‹œì˜ˆì™¸ ë°œìƒ
		- í”„ë ˆì„ ì½ê¸° ì‹¤íŒ¨ ì‹œ ìë™ ê±´ë„ˆë›°ê¸°

**6. YOLOëª¨ë¸ fuse() í˜¸í™˜ì„± ë¬¸ì œ í•´ê²° ë°©ì•ˆ**
- fuse()ì™„ì „ ë¹„í™œì„±í™”
```
a. ëª¨ë¸ ì´ˆê¸°í™” ì§í›„ model.fuseë¥¼ ëŒë‹¤í•¨ìˆ˜ë¡œ ì¬ì •ì˜
b. predictë©”ì„œë“œ ì˜¤ë²„ë¼ì´ë“œë¡œ ì´ì¤‘ ë³´ì•ˆ
```

- ìµœì‹  íŒŒì´í† ì¹˜ AMP API ì ìš©
```
a. torch.amp.autocastë¡œ ê²½ê³  í•´ê²°
b. device_typeê³¼ dtype ëª…ì‹œì  ì§€ì •
  --> AttributeError : bn ì˜¤ë¥˜ í•´ê²°, AMP ê´€ë ¨ ê²½ê³ ë©”ì‹œì§€ í•´ê²°, YOLOv11nê³¼ Ultralytics ë¼ì´ë¸ŒëŸ¬ë¦¬ í˜¸í™˜ì„± ë¬¸ì œ í•´ê²°
```

**7. ì¬ê·€ ê¹Šì´ ì´ˆê³¼ ì˜¤ë¥˜(RecursionError) í•´ê²°**
- model.predict ì˜¤ë²„ë¼ì´ë“œ ì‹œ ì›ë³¸ ë©”ì„œë“œë¥¼ ì°¸ì¡°í•˜ë„ë¡ ìˆ˜ì •
- ëŒë‹¤ í•¨ìˆ˜ê°€ ìê¸° ìì‹ ì„ í˜¸ì¶œí•˜ì§€ ì•Šë„ë¡ êµ¬ì¡° ë³€ê²½
- original_predict ë³€ìˆ˜ë¡œ ì›ë³¸ ë©”ì„œë“œ ë³´ì¡´
- fuse ë©”ì„œë“œ ì™„ì „ ë¬´ë ¥í™”

Check out the configuration reference at https://huggingface.co/docs/hub/spaces-config-reference
